{
    "sourceFile": "src/core/page/SearchPage/index.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 42,
            "patches": [
                {
                    "date": 1643619190405,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1643619218137,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -81,8 +81,9 @@\n             Save on your medications today!\r\n           </h1>\r\n \r\n           <div className=\"search-page__input-wrapper\">\r\n+            <AutoSuggestInput autocomplete={search.length >= 3 && group === false ? state : []} />\r\n           <InputField\r\n               iconUrl={SearchIconSvg}\r\n               value={search}\r\n               placeholder=\"Search Medications\"\r\n"
                },
                {
                    "date": 1643619893100,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -81,9 +81,9 @@\n             Save on your medications today!\r\n           </h1>\r\n \r\n           <div className=\"search-page__input-wrapper\">\r\n-            <AutoSuggestInput autocomplete={search.length >= 3 && group === false ? state : []} />\r\n+            <AutoSuggestInput autocomplete={stae} />\r\n           <InputField\r\n               iconUrl={SearchIconSvg}\r\n               value={search}\r\n               placeholder=\"Search Medications\"\r\n"
                },
                {
                    "date": 1643620645191,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -81,9 +81,8 @@\n             Save on your medications today!\r\n           </h1>\r\n \r\n           <div className=\"search-page__input-wrapper\">\r\n-            <AutoSuggestInput autocomplete={stae} />\r\n           <InputField\r\n               iconUrl={SearchIconSvg}\r\n               value={search}\r\n               placeholder=\"Search Medications\"\r\n"
                },
                {
                    "date": 1643623964658,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -81,8 +81,9 @@\n             Save on your medications today!\r\n           </h1>\r\n \r\n           <div className=\"search-page__input-wrapper\">\r\n+            <AutoSuggestInput autocomplete={state} />\r\n           <InputField\r\n               iconUrl={SearchIconSvg}\r\n               value={search}\r\n               placeholder=\"Search Medications\"\r\n"
                },
                {
                    "date": 1643951492028,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,6 +1,7 @@\n-import React, {useState, useEffect, useCallback} from \"react\";\r\n+import React, {useState, useEffect, useCallback, useRef} from \"react\";\r\n import { Footer, InputField } from \"../../components\";\r\n+import InputAutoSuggest from '../../components/InputAutoSuggest';\r\n import { useDispatch, useSelector } from \"react-redux\";\r\n import { useCookies } from \"react-cookie\";\r\n import { useHistory } from \"react-router-dom\";\r\n import TopMed from \"../../store/topMed/action\";\r\n@@ -17,21 +18,18 @@\n \r\n export const SearchPage: React.FC = () => {\r\n   const history = useHistory();\r\n   const state = useSelector((state:any) => state.topMedReducer.top);\r\n-  const grouping = useSelector((state:any) => state.topMedReducer.group)\r\n-  const [group,setGroup] = useState(false);\r\n-  const zip = useSelector((zip:any) => zip.zipReducer);\r\n+  const zip = useSelector((zip:any) => zip.zipReducer.sort((a:any,b:any) => {return (a.label < b.label)? -1 :(a.label > b.label) ? 1 : 0 }));\r\n   const data = useSelector((state:any) => state.currentReducer);\r\n   const [cookies, setCookies] = useCookies();\r\n   const [search, setSearch] = useState(\"\");\r\n   const [error,setError] = useState(false);\r\n   const [zipError,setZipError] = useState(false);\r\n   const [codes, setCodes] = useState(\"\");\r\n-  const [groups,setGroups] = useState([]);\r\n-  const [filteredItems,setFilteredItems] = useState([]);\r\n+  const [searchBool, setSearchBool] = useState(false);\r\n+  const [zipBool, setZipBool] = useState(false);\r\n   const dispatch = useDispatch();\r\n-\r\n   useEffect(() => {\r\n     \r\n     dispatch(TopMed({authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}));\r\n     \r\n@@ -55,18 +53,153 @@\n         }\r\n       })\r\n     }\r\n   }, [data]);\r\n+  // const submitAction = () => {\r\n+  //   const item = state.map(({label}:any) => {\r\n+  //     return {\r\n+  //       label: label.filter(({label}:any) => label === search)\r\n+  //     }\r\n+  //   }).filter(({label}:any) => label.length > 0)[0]\r\n+  //   console.log(item);\r\n+  //   if(search && codes && item.label[0].label){\r\n+  //     dispatch(CurrentMed(search,{authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}))\r\n+  //     return true;\r\n+  //   }else{\r\n+  //     codes ? setZipError(false) :setZipError(true);\r\n+  //     search && state.filter((item:any) => item.label.label === search)[0] ? setError(false) : setError(true);\r\n+  //     return false;\r\n+  //   }\r\n+  // }\r\n+  const escapedRegexCharacters =(str:any) => {\r\n+    return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n+  }\r\n   const submitAction = () => {\r\n-    if(search && codes && state.filter((item:any) => item.label === search || item.label.label === search)[0]){\r\n-      dispatch(CurrentMed(search,{authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}))\r\n-      return true;\r\n-    }else{\r\n-      codes ? setZipError(false) :setZipError(true);\r\n-      search && state.filter((item:any) => item.label.label === search)[0] ? setError(false) : setError(true);\r\n-      return false;\r\n+    const escaped = escapedRegexCharacters(search.trim());\r\n+    const regex = new RegExp('^' + escaped, 'i');\r\n+\r\n+    if(search.length > 0){\r\n+    const searchSubmit = state.map(({label}:any) => {\r\n+      return {\r\n+        label: label.filter(({label}:any) => regex.test(label))\r\n+      }\r\n+    })\r\n+    .filter(({label}:any) => label.length > 0)\r\n+    if(searchSubmit.length === 0){\r\n+      setError(true)\r\n+      return;\r\n     }\r\n+    const sorting = searchSubmit.map(({label}:any) => label).flat()\r\n+    .sort((a:any,b:any) => {\r\n+      return (a.label < b.label) ? -1 : (a.label > b.label) ? 1 : 0;\r\n+    }).map((e:any) => {\r\n+      return {\r\n+        label:[{label: e.label, type: e.type}]\r\n+      }\r\n+    })[0].label[0].label; \r\n+    setSearchBool(true);\r\n+    setSearch(sorting);\r\n+    return ;\r\n+  }else{\r\n+    setSearchBool(false);\r\n+    setError(true);\r\n+    return ;\r\n+\r\n   }\r\n+\r\n+  \r\n+}\r\n+\r\n+const submitActionZip = () => {\r\n+  // try{\r\n+  //   setCodes(zip[0].label);\r\n+  //   return setZipBool(true);\r\n+  \r\n+  // }catch(e){\r\n+  //   setZipError(true);\r\n+  //   setZipBool(false);\r\n+  //   return;\r\n+  // }\r\n+  if(codes.length >= 3 && zip.length >= 1 ){\r\n+    setCodes(zip[0].label);\r\n+    setZipBool(true);\r\n+    return;\r\n+  }else{\r\n+    setZipBool(false)\r\n+    setZipError(false);\r\n+    return;\r\n+  }\r\n+}\r\n+  useEffect(() => {\r\n+    if(search.length > 0){\r\n+      setError(false);\r\n+    }\r\n+  },[search])\r\n+  useEffect(() => {\r\n+    if(codes.length > 0 ){\r\n+      setZipError(false);\r\n+    }\r\n+  },[codes]);\r\n+\r\n+\r\n+  useEffect(() => {\r\n+\r\n+    if(zipBool && searchBool ){\r\n+      const timer = setTimeout(() => {\r\n+        dispatch(CurrentMed(search,{authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}))\r\n+      }, 500)\r\n+      return () => {\r\n+        clearTimeout(timer);\r\n+      }  \r\n+    }\r\n+    \r\n+  },[zipBool,searchBool, search, codes])\r\n+\r\n+  useEffect(() => {\r\n+    \r\n+    const handleClick = (event:any) => {\r\n+     \r\n+      const {key} = event;\r\n+      if(key === 'Enter' && search.length){\r\n+        console.log('click med')\r\n+          try{\r\n+          submitAction();\r\n+          }catch(e){\r\n+            console.error(e);\r\n+          }\r\n+        \r\n+      }\r\n+    }\r\n+\r\n+    document.addEventListener('keydown', handleClick);\r\n+\r\n+    return () => {\r\n+      document.removeEventListener('keydown', handleClick);\r\n+    }\r\n+  },[submitAction, search]);\r\n+  useEffect(() => {\r\n+    \r\n+    const handleClick = (event:any) => {\r\n+      \r\n+      const {key} = event;\r\n+      if(key === 'Enter' && codes.length){\r\n+        console.log('click zip')\r\n+          try{\r\n+            submitActionZip();\r\n+          }catch(e){\r\n+            setError(true);\r\n+            console.error(e);\r\n+          }\r\n+        \r\n+      }\r\n+    }\r\n+\r\n+    document.addEventListener('keyup', handleClick);\r\n+\r\n+    return () => {\r\n+      document.removeEventListener('keyup', handleClick);\r\n+    }\r\n+  },[submitActionZip, codes]);\r\n   return (\r\n     <div className=\"search-page\">\r\n       <div>\r\n         <div className=\"search-page__header\">\r\n@@ -81,34 +214,29 @@\n             Save on your medications today!\r\n           </h1>\r\n \r\n           <div className=\"search-page__input-wrapper\">\r\n-            <AutoSuggestInput autocomplete={state} />\r\n-          <InputField\r\n+            \r\n+            <InputAutoSuggest\r\n+              value={search}\r\n+              setValue={setSearch}\r\n+              autocomplete={state}\r\n               iconUrl={SearchIconSvg}\r\n-              value={search}\r\n               placeholder=\"Search Medications\"\r\n-              onChange={setSearch}\r\n-              onSubmit={submitAction}\r\n-              buttonText=\"Find lowest prices\"\r\n-              autocomplete={search.length >= 3 && group === false ? state : []}\r\n-              errorHandle={error}\r\n-              grouping={true}\r\n-              filtered={filteredItems}\r\n-              setFiltered={setFilteredItems}\r\n-              // error=\"Please type correct medication\"\r\n+              error={error}\r\n             />\r\n             {error ? (\r\n-              <p className=\"error_message\">Please choose correct medication</p>\r\n-            ) : (\r\n-              <p></p>\r\n+                 <p className=\"error_message\">Please choose correct medication</p>\r\n+                 ) : (\r\n+                   <p></p>\r\n             )}\r\n+            \r\n             <InputField\r\n               iconUrl={LocationIconSvg}\r\n               value={codes}\r\n               placeholder=\"ZIP (enter at least 3 characters)\"\r\n               onChange={setCodes}\r\n-              onSubmit={submitAction}\r\n+              onSubmit={submitActionZip}\r\n               buttonText=\"Find lowest prices\"\r\n               autocomplete={zip}\r\n               errorHandle={zipError}\r\n               haveSubmit\r\n@@ -118,8 +246,9 @@\n               <p className=\"error_message\">Please choose correct Zip code</p>\r\n             ) : (\r\n               <p></p>\r\n             )}\r\n+            \r\n           </div>\r\n         </div>\r\n       </div>\r\n       <Footer />\r\n"
                },
                {
                    "date": 1643951589355,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -118,9 +118,9 @@\n   //   setZipError(true);\r\n   //   setZipBool(false);\r\n   //   return;\r\n   // }\r\n-  if(codes.length >= 3 && zip.length >= 1 ){\r\n+  if(codes.length >= 3 && zip.length ){\r\n     setCodes(zip[0].label);\r\n     setZipBool(true);\r\n     return;\r\n   }else{\r\n"
                },
                {
                    "date": 1643951679500,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -185,9 +185,8 @@\n         console.log('click zip')\r\n           try{\r\n             submitActionZip();\r\n           }catch(e){\r\n-            setError(true);\r\n             console.error(e);\r\n           }\r\n         \r\n       }\r\n"
                },
                {
                    "date": 1643952218063,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -228,9 +228,9 @@\n                  ) : (\r\n                    <p></p>\r\n             )}\r\n             \r\n-            <InputField\r\n+            {/* <InputField\r\n               iconUrl={LocationIconSvg}\r\n               value={codes}\r\n               placeholder=\"ZIP (enter at least 3 characters)\"\r\n               onChange={setCodes}\r\n@@ -239,8 +239,16 @@\n               autocomplete={zip}\r\n               errorHandle={zipError}\r\n               haveSubmit\r\n               // error=\"Please type correct ZIP code\"\r\n+            /> */}\r\n+            <InputAutoSuggest\r\n+              value={codes}\r\n+              setValue={setCodes}\r\n+              autocomplete={zip}\r\n+              placeholder=\"ZIP (enter at least 3 characters)\"\r\n+              error={zipError}\r\n+              haveSubmit\r\n             />\r\n             {zipError ? (\r\n               <p className=\"error_message\">Please choose correct Zip code</p>\r\n             ) : (\r\n"
                },
                {
                    "date": 1643952224484,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -247,8 +247,9 @@\n               autocomplete={zip}\r\n               placeholder=\"ZIP (enter at least 3 characters)\"\r\n               error={zipError}\r\n               haveSubmit\r\n+              \r\n             />\r\n             {zipError ? (\r\n               <p className=\"error_message\">Please choose correct Zip code</p>\r\n             ) : (\r\n"
                },
                {
                    "date": 1643952276464,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -247,9 +247,10 @@\n               autocomplete={zip}\r\n               placeholder=\"ZIP (enter at least 3 characters)\"\r\n               error={zipError}\r\n               haveSubmit\r\n-              \r\n+              buttonText=\"Find lowest price\"\r\n+              onSubmit={submitActionZip}\r\n             />\r\n             {zipError ? (\r\n               <p className=\"error_message\">Please choose correct Zip code</p>\r\n             ) : (\r\n"
                },
                {
                    "date": 1643952302498,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -244,8 +244,9 @@\n             <InputAutoSuggest\r\n               value={codes}\r\n               setValue={setCodes}\r\n               autocomplete={zip}\r\n+              iconUrl={LocationIconSvg}\r\n               placeholder=\"ZIP (enter at least 3 characters)\"\r\n               error={zipError}\r\n               haveSubmit\r\n               buttonText=\"Find lowest price\"\r\n"
                },
                {
                    "date": 1643952945888,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,19 +31,19 @@\n   const dispatch = useDispatch();\r\n   useEffect(() => {\r\n     \r\n     dispatch(TopMed({authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}));\r\n-    \r\n+    dispatch(SearchZip(codes));\r\n   }, []);\r\n \r\n-  useEffect(() => {\r\n-    if(codes){\r\n-      dispatch(SearchZip(codes));\r\n-    }\r\n+  // useEffect(() => {\r\n+  //   if(codes){\r\n+      \r\n+  //   }\r\n     \r\n-    return () => {dispatch(ClearZip())}\r\n+  //   return () => {dispatch(ClearZip())}\r\n     \r\n-  },[codes,dispatch]);\r\n+  // },[codes,dispatch]);\r\n   useEffect(() => {\r\n     if(data.name){\r\n         history.push({\r\n         pathname:\"/results\",\r\n"
                },
                {
                    "date": 1643953215068,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,11 +31,13 @@\n   const dispatch = useDispatch();\r\n   useEffect(() => {\r\n     \r\n     dispatch(TopMed({authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}));\r\n-    dispatch(SearchZip(codes));\r\n+    \r\n   }, []);\r\n-\r\n+  useEffect(() => {\r\n+    dispatch(SearchZip());\r\n+  },[])\r\n   // useEffect(() => {\r\n   //   if(codes){\r\n       \r\n   //   }\r\n"
                },
                {
                    "date": 1643953241714,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,13 +31,11 @@\n   const dispatch = useDispatch();\r\n   useEffect(() => {\r\n     \r\n     dispatch(TopMed({authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}));\r\n-    \r\n+    dispatch(SearchZip());\r\n   }, []);\r\n-  useEffect(() => {\r\n-    dispatch(SearchZip());\r\n-  },[])\r\n+\r\n   // useEffect(() => {\r\n   //   if(codes){\r\n       \r\n   //   }\r\n"
                },
                {
                    "date": 1643953310266,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -31,19 +31,18 @@\n   const dispatch = useDispatch();\r\n   useEffect(() => {\r\n     \r\n     dispatch(TopMed({authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}));\r\n-    dispatch(SearchZip());\r\n   }, []);\r\n \r\n-  // useEffect(() => {\r\n-  //   if(codes){\r\n-      \r\n-  //   }\r\n+  useEffect(() => {\r\n+    if(codes){\r\n+      dispatch(SearchZip(codes));\r\n+    }\r\n     \r\n-  //   return () => {dispatch(ClearZip())}\r\n+    return () => {dispatch(ClearZip())}\r\n     \r\n-  // },[codes,dispatch]);\r\n+  },[codes,dispatch]);\r\n   useEffect(() => {\r\n     if(data.name){\r\n         history.push({\r\n         pathname:\"/results\",\r\n"
                },
                {
                    "date": 1643953543231,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,9 @@\n \r\n export const SearchPage: React.FC = () => {\r\n   const history = useHistory();\r\n   const state = useSelector((state:any) => state.topMedReducer.top);\r\n-  const zip = useSelector((zip:any) => zip.zipReducer.sort((a:any,b:any) => {return (a.label < b.label)? -1 :(a.label > b.label) ? 1 : 0 }));\r\n+  const zip = useSelector((zip:any) => zip.zipReducer );\r\n   const data = useSelector((state:any) => state.currentReducer);\r\n   const [cookies, setCookies] = useCookies();\r\n   const [search, setSearch] = useState(\"\");\r\n   const [error,setError] = useState(false);\r\n"
                },
                {
                    "date": 1643953670499,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,9 +38,9 @@\n     if(codes){\r\n       dispatch(SearchZip(codes));\r\n     }\r\n     \r\n-    return () => {dispatch(ClearZip())}\r\n+    // return () => {dispatch(ClearZip())}\r\n     \r\n   },[codes,dispatch]);\r\n   useEffect(() => {\r\n     if(data.name){\r\n"
                },
                {
                    "date": 1643953719637,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -34,9 +34,9 @@\n     dispatch(TopMed({authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}));\r\n   }, []);\r\n \r\n   useEffect(() => {\r\n-    if(codes){\r\n+    if(codes.length){\r\n       dispatch(SearchZip(codes));\r\n     }\r\n     \r\n     // return () => {dispatch(ClearZip())}\r\n"
                },
                {
                    "date": 1643953757502,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,9 +38,9 @@\n     if(codes.length){\r\n       dispatch(SearchZip(codes));\r\n     }\r\n     \r\n-    // return () => {dispatch(ClearZip())}\r\n+    return () => {dispatch(ClearZip())}\r\n     \r\n   },[codes,dispatch]);\r\n   useEffect(() => {\r\n     if(data.name){\r\n"
                },
                {
                    "date": 1643953771723,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -227,9 +227,9 @@\n                  ) : (\r\n                    <p></p>\r\n             )}\r\n             \r\n-            {/* <InputField\r\n+            <InputField\r\n               iconUrl={LocationIconSvg}\r\n               value={codes}\r\n               placeholder=\"ZIP (enter at least 3 characters)\"\r\n               onChange={setCodes}\r\n@@ -238,10 +238,10 @@\n               autocomplete={zip}\r\n               errorHandle={zipError}\r\n               haveSubmit\r\n               // error=\"Please type correct ZIP code\"\r\n-            /> */}\r\n-            <InputAutoSuggest\r\n+            />\r\n+            {/* <InputAutoSuggest\r\n               value={codes}\r\n               setValue={setCodes}\r\n               autocomplete={zip}\r\n               iconUrl={LocationIconSvg}\r\n@@ -254,9 +254,9 @@\n             {zipError ? (\r\n               <p className=\"error_message\">Please choose correct Zip code</p>\r\n             ) : (\r\n               <p></p>\r\n-            )}\r\n+            )} */}\r\n             \r\n           </div>\r\n         </div>\r\n       </div>\r\n"
                },
                {
                    "date": 1643953833373,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,9 +18,9 @@\n \r\n export const SearchPage: React.FC = () => {\r\n   const history = useHistory();\r\n   const state = useSelector((state:any) => state.topMedReducer.top);\r\n-  const zip = useSelector((zip:any) => zip.zipReducer );\r\n+  const zip = useSelector((zip:any) => zip.zipReducer.sort((a:any, b:any) => {return (a.label < b.label) ? -1 : (a.label > b.label) ? 1 : 0;}) );\r\n   const data = useSelector((state:any) => state.currentReducer);\r\n   const [cookies, setCookies] = useCookies();\r\n   const [search, setSearch] = useState(\"\");\r\n   const [error,setError] = useState(false);\r\n"
                },
                {
                    "date": 1643954038149,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -150,9 +150,9 @@\n         clearTimeout(timer);\r\n       }  \r\n     }\r\n     \r\n-  },[zipBool,searchBool, search, codes])\r\n+  },[zipBool,searchBool])\r\n \r\n   useEffect(() => {\r\n     \r\n     const handleClick = (event:any) => {\r\n"
                },
                {
                    "date": 1643954048037,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -174,8 +174,10 @@\n     return () => {\r\n       document.removeEventListener('keydown', handleClick);\r\n     }\r\n   },[submitAction, search]);\r\n+\r\n+  \r\n   useEffect(() => {\r\n     \r\n     const handleClick = (event:any) => {\r\n       \r\n"
                },
                {
                    "date": 1643954057233,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -158,9 +158,8 @@\n     const handleClick = (event:any) => {\r\n      \r\n       const {key} = event;\r\n       if(key === 'Enter' && search.length){\r\n-        console.log('click med')\r\n           try{\r\n           submitAction();\r\n           }catch(e){\r\n             console.error(e);\r\n@@ -175,9 +174,9 @@\n       document.removeEventListener('keydown', handleClick);\r\n     }\r\n   },[submitAction, search]);\r\n \r\n-  \r\n+\r\n   useEffect(() => {\r\n     \r\n     const handleClick = (event:any) => {\r\n       \r\n"
                },
                {
                    "date": 1643954132367,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -175,30 +175,30 @@\n     }\r\n   },[submitAction, search]);\r\n \r\n \r\n-  useEffect(() => {\r\n+  // useEffect(() => {\r\n     \r\n-    const handleClick = (event:any) => {\r\n+  //   const handleClick = (event:any) => {\r\n       \r\n-      const {key} = event;\r\n-      if(key === 'Enter' && codes.length){\r\n-        console.log('click zip')\r\n-          try{\r\n-            submitActionZip();\r\n-          }catch(e){\r\n-            console.error(e);\r\n-          }\r\n+  //     const {key} = event;\r\n+  //     if(key === 'Enter' && codes.length){\r\n+  //       console.log('click zip')\r\n+  //         try{\r\n+  //           submitActionZip();\r\n+  //         }catch(e){\r\n+  //           console.error(e);\r\n+  //         }\r\n         \r\n-      }\r\n-    }\r\n+  //     }\r\n+  //   }\r\n \r\n-    document.addEventListener('keyup', handleClick);\r\n+  //   document.addEventListener('keyup', handleClick);\r\n \r\n-    return () => {\r\n-      document.removeEventListener('keyup', handleClick);\r\n-    }\r\n-  },[submitActionZip, codes]);\r\n+  //   return () => {\r\n+  //     document.removeEventListener('keyup', handleClick);\r\n+  //   }\r\n+  // },[submitActionZip, codes]);\r\n   return (\r\n     <div className=\"search-page\">\r\n       <div>\r\n         <div className=\"search-page__header\">\r\n"
                },
                {
                    "date": 1643954176619,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -52,24 +52,9 @@\n         }\r\n       })\r\n     }\r\n   }, [data]);\r\n-  // const submitAction = () => {\r\n-  //   const item = state.map(({label}:any) => {\r\n-  //     return {\r\n-  //       label: label.filter(({label}:any) => label === search)\r\n-  //     }\r\n-  //   }).filter(({label}:any) => label.length > 0)[0]\r\n-  //   console.log(item);\r\n-  //   if(search && codes && item.label[0].label){\r\n-  //     dispatch(CurrentMed(search,{authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}))\r\n-  //     return true;\r\n-  //   }else{\r\n-  //     codes ? setZipError(false) :setZipError(true);\r\n-  //     search && state.filter((item:any) => item.label.label === search)[0] ? setError(false) : setError(true);\r\n-  //     return false;\r\n-  //   }\r\n-  // }\r\n+  \r\n   const escapedRegexCharacters =(str:any) => {\r\n     return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n   }\r\n   const submitAction = () => {\r\n"
                },
                {
                    "date": 1643954188209,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -52,9 +52,9 @@\n         }\r\n       })\r\n     }\r\n   }, [data]);\r\n-  \r\n+\r\n   const escapedRegexCharacters =(str:any) => {\r\n     return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n   }\r\n   const submitAction = () => {\r\n@@ -93,26 +93,9 @@\n   \r\n }\r\n \r\n const submitActionZip = () => {\r\n-  // try{\r\n-  //   setCodes(zip[0].label);\r\n-  //   return setZipBool(true);\r\n-  \r\n-  // }catch(e){\r\n-  //   setZipError(true);\r\n-  //   setZipBool(false);\r\n-  //   return;\r\n-  // }\r\n-  if(codes.length >= 3 && zip.length ){\r\n-    setCodes(zip[0].label);\r\n-    setZipBool(true);\r\n-    return;\r\n-  }else{\r\n-    setZipBool(false)\r\n-    setZipError(false);\r\n-    return;\r\n-  }\r\n+ \r\n }\r\n   useEffect(() => {\r\n     if(search.length > 0){\r\n       setError(false);\r\n"
                },
                {
                    "date": 1643954275513,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -93,9 +93,18 @@\n   \r\n }\r\n \r\n const submitActionZip = () => {\r\n- \r\n+ const data = zip[0].label;\r\n+ if(!data){\r\n+   setZipError(true)\r\n+   setZipBool(false)\r\n+   return;\r\n+ }\r\n+ setCodes(data);\r\n+ setZipBool(true);\r\n+ return;\r\n+\r\n }\r\n   useEffect(() => {\r\n     if(search.length > 0){\r\n       setError(false);\r\n"
                },
                {
                    "date": 1643954324819,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -152,30 +152,30 @@\n     }\r\n   },[submitAction, search]);\r\n \r\n \r\n-  // useEffect(() => {\r\n+  useEffect(() => {\r\n     \r\n-  //   const handleClick = (event:any) => {\r\n+    const handleClick = (event:any) => {\r\n       \r\n-  //     const {key} = event;\r\n-  //     if(key === 'Enter' && codes.length){\r\n-  //       console.log('click zip')\r\n-  //         try{\r\n-  //           submitActionZip();\r\n-  //         }catch(e){\r\n-  //           console.error(e);\r\n-  //         }\r\n+      const {key} = event;\r\n+      if(key === 'Enter' && codes.length){\r\n+        console.log('click zip')\r\n+          try{\r\n+            submitActionZip();\r\n+          }catch(e){\r\n+            console.error(e);\r\n+          }\r\n         \r\n-  //     }\r\n-  //   }\r\n+      }\r\n+    }\r\n \r\n-  //   document.addEventListener('keyup', handleClick);\r\n+    document.addEventListener('keyup', handleClick);\r\n \r\n-  //   return () => {\r\n-  //     document.removeEventListener('keyup', handleClick);\r\n-  //   }\r\n-  // },[submitActionZip, codes]);\r\n+    return () => {\r\n+      document.removeEventListener('keyup', handleClick);\r\n+    }\r\n+  },[submitActionZip, codes]);\r\n   return (\r\n     <div className=\"search-page\">\r\n       <div>\r\n         <div className=\"search-page__header\">\r\n"
                },
                {
                    "date": 1643954358619,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -168,12 +168,12 @@\n         \r\n       }\r\n     }\r\n \r\n-    document.addEventListener('keyup', handleClick);\r\n+    document.addEventListener('keydown', handleClick);\r\n \r\n     return () => {\r\n-      document.removeEventListener('keyup', handleClick);\r\n+      document.removeEventListener('keydown', handleClick);\r\n     }\r\n   },[submitActionZip, codes]);\r\n   return (\r\n     <div className=\"search-page\">\r\n"
                },
                {
                    "date": 1643954436246,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -144,12 +144,12 @@\n         \r\n       }\r\n     }\r\n \r\n-    document.addEventListener('keydown', handleClick);\r\n+    document.addEventListener('keypress', handleClick);\r\n \r\n     return () => {\r\n-      document.removeEventListener('keydown', handleClick);\r\n+      document.removeEventListener('keypress', handleClick);\r\n     }\r\n   },[submitAction, search]);\r\n \r\n \r\n"
                },
                {
                    "date": 1643954454287,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -144,12 +144,12 @@\n         \r\n       }\r\n     }\r\n \r\n-    document.addEventListener('keypress', handleClick);\r\n+    document.addEventListener('keydown', handleClick);\r\n \r\n     return () => {\r\n-      document.removeEventListener('keypress', handleClick);\r\n+      document.removeEventListener('keydown', handleClick);\r\n     }\r\n   },[submitAction, search]);\r\n \r\n \r\n"
                },
                {
                    "date": 1643954468982,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -168,12 +168,12 @@\n         \r\n       }\r\n     }\r\n \r\n-    document.addEventListener('keydown', handleClick);\r\n+    document.addEventListener('keypress', handleClick);\r\n \r\n     return () => {\r\n-      document.removeEventListener('keydown', handleClick);\r\n+      document.removeEventListener('keypress', handleClick);\r\n     }\r\n   },[submitActionZip, codes]);\r\n   return (\r\n     <div className=\"search-page\">\r\n"
                },
                {
                    "date": 1643954514457,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -149,33 +149,33 @@\n \r\n     return () => {\r\n       document.removeEventListener('keydown', handleClick);\r\n     }\r\n-  },[submitAction, search]);\r\n+  },[submitAction, search, codes, submitActionZip]);\r\n \r\n \r\n-  useEffect(() => {\r\n+  // useEffect(() => {\r\n     \r\n-    const handleClick = (event:any) => {\r\n+  //   const handleClick = (event:any) => {\r\n       \r\n-      const {key} = event;\r\n-      if(key === 'Enter' && codes.length){\r\n-        console.log('click zip')\r\n-          try{\r\n-            submitActionZip();\r\n-          }catch(e){\r\n-            console.error(e);\r\n-          }\r\n+  //     const {key} = event;\r\n+  //     if(key === 'Enter' && codes.length){\r\n+  //       console.log('click zip')\r\n+  //         try{\r\n+  //           submitActionZip();\r\n+  //         }catch(e){\r\n+  //           console.error(e);\r\n+  //         }\r\n         \r\n-      }\r\n-    }\r\n+  //     }\r\n+  //   }\r\n \r\n-    document.addEventListener('keypress', handleClick);\r\n+  //   document.addEventListener('keypress', handleClick);\r\n \r\n-    return () => {\r\n-      document.removeEventListener('keypress', handleClick);\r\n-    }\r\n-  },[submitActionZip, codes]);\r\n+  //   return () => {\r\n+  //     document.removeEventListener('keypress', handleClick);\r\n+  //   }\r\n+  // },[submitActionZip, codes]);\r\n   return (\r\n     <div className=\"search-page\">\r\n       <div>\r\n         <div className=\"search-page__header\">\r\n"
                },
                {
                    "date": 1643954560324,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -134,15 +134,23 @@\n     \r\n     const handleClick = (event:any) => {\r\n      \r\n       const {key} = event;\r\n-      if(key === 'Enter' && search.length){\r\n-          try{\r\n+      // if(key === 'Enter' && search.length){\r\n+      //     try{\r\n+      //     submitAction();\r\n+      //     }catch(e){\r\n+      //       console.error(e);\r\n+      //     }\r\n+        \r\n+      // }\r\n+      if(key === 'Enter'){\r\n+        if(search.length){\r\n           submitAction();\r\n-          }catch(e){\r\n-            console.error(e);\r\n-          }\r\n-        \r\n+        }\r\n+        if(codes.length){\r\n+          submitActionZip();\r\n+        }\r\n       }\r\n     }\r\n \r\n     document.addEventListener('keydown', handleClick);\r\n"
                },
                {
                    "date": 1643954638353,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -93,8 +93,13 @@\n   \r\n }\r\n \r\n const submitActionZip = () => {\r\n+  if(!zip[0].label){\r\n+    setZipBool(false)\r\n+    setZipError(true);\r\n+    return;\r\n+  }\r\n  const data = zip[0].label;\r\n  if(!data){\r\n    setZipError(true)\r\n    setZipBool(false)\r\n"
                },
                {
                    "date": 1643954715758,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -93,22 +93,29 @@\n   \r\n }\r\n \r\n const submitActionZip = () => {\r\n-  if(!zip[0].label){\r\n-    setZipBool(false)\r\n-    setZipError(true);\r\n-    return;\r\n-  }\r\n- const data = zip[0].label;\r\n- if(!data){\r\n-   setZipError(true)\r\n-   setZipBool(false)\r\n-   return;\r\n- }\r\n- setCodes(data);\r\n- setZipBool(true);\r\n- return;\r\n+//   if(!zip[0].label){\r\n+//     setZipBool(false)\r\n+//     setZipError(true);\r\n+//     return;\r\n+//   }\r\n+//  const data = zip[0].label;\r\n+//  if(!data){\r\n+//    setZipError(true)\r\n+//    setZipBool(false)\r\n+//    return;\r\n+//  }\r\n+//  setCodes(data);\r\n+//  setZipBool(true);\r\n+//  return;\r\n+try{\r\n+  setCodes(zip[0].label)l\r\n+}catch(e){\r\n+  setZipError(true);\r\n+  setZipBool(false);\r\n+  return;\r\n+}\r\n \r\n }\r\n   useEffect(() => {\r\n     if(search.length > 0){\r\n"
                },
                {
                    "date": 1643954721317,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -108,9 +108,10 @@\n //  setCodes(data);\r\n //  setZipBool(true);\r\n //  return;\r\n try{\r\n-  setCodes(zip[0].label)l\r\n+  setCodes(zip[0].label);\r\n+  setZipBool(true);\r\n }catch(e){\r\n   setZipError(true);\r\n   setZipBool(false);\r\n   return;\r\n"
                },
                {
                    "date": 1643954728961,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -110,8 +110,9 @@\n //  return;\r\n try{\r\n   setCodes(zip[0].label);\r\n   setZipBool(true);\r\n+  return;\r\n }catch(e){\r\n   setZipError(true);\r\n   setZipBool(false);\r\n   return;\r\n"
                },
                {
                    "date": 1643954830854,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -239,24 +239,13 @@\n               errorHandle={zipError}\r\n               haveSubmit\r\n               // error=\"Please type correct ZIP code\"\r\n             />\r\n-            {/* <InputAutoSuggest\r\n-              value={codes}\r\n-              setValue={setCodes}\r\n-              autocomplete={zip}\r\n-              iconUrl={LocationIconSvg}\r\n-              placeholder=\"ZIP (enter at least 3 characters)\"\r\n-              error={zipError}\r\n-              haveSubmit\r\n-              buttonText=\"Find lowest price\"\r\n-              onSubmit={submitActionZip}\r\n-            />\r\n             {zipError ? (\r\n               <p className=\"error_message\">Please choose correct Zip code</p>\r\n             ) : (\r\n               <p></p>\r\n-            )} */}\r\n+            )}\r\n             \r\n           </div>\r\n         </div>\r\n       </div>\r\n"
                },
                {
                    "date": 1643955270077,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -148,16 +148,8 @@\n     \r\n     const handleClick = (event:any) => {\r\n      \r\n       const {key} = event;\r\n-      // if(key === 'Enter' && search.length){\r\n-      //     try{\r\n-      //     submitAction();\r\n-      //     }catch(e){\r\n-      //       console.error(e);\r\n-      //     }\r\n-        \r\n-      // }\r\n       if(key === 'Enter'){\r\n         if(search.length){\r\n           submitAction();\r\n         }\r\n@@ -174,30 +166,8 @@\n     }\r\n   },[submitAction, search, codes, submitActionZip]);\r\n \r\n \r\n-  // useEffect(() => {\r\n-    \r\n-  //   const handleClick = (event:any) => {\r\n-      \r\n-  //     const {key} = event;\r\n-  //     if(key === 'Enter' && codes.length){\r\n-  //       console.log('click zip')\r\n-  //         try{\r\n-  //           submitActionZip();\r\n-  //         }catch(e){\r\n-  //           console.error(e);\r\n-  //         }\r\n-        \r\n-  //     }\r\n-  //   }\r\n-\r\n-  //   document.addEventListener('keypress', handleClick);\r\n-\r\n-  //   return () => {\r\n-  //     document.removeEventListener('keypress', handleClick);\r\n-  //   }\r\n-  // },[submitActionZip, codes]);\r\n   return (\r\n     <div className=\"search-page\">\r\n       <div>\r\n         <div className=\"search-page__header\">\r\n"
                },
                {
                    "date": 1643958167484,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -93,22 +93,8 @@\n   \r\n }\r\n \r\n const submitActionZip = () => {\r\n-//   if(!zip[0].label){\r\n-//     setZipBool(false)\r\n-//     setZipError(true);\r\n-//     return;\r\n-//   }\r\n-//  const data = zip[0].label;\r\n-//  if(!data){\r\n-//    setZipError(true)\r\n-//    setZipBool(false)\r\n-//    return;\r\n-//  }\r\n-//  setCodes(data);\r\n-//  setZipBool(true);\r\n-//  return;\r\n try{\r\n   setCodes(zip[0].label);\r\n   setZipBool(true);\r\n   return;\r\n"
                }
            ],
            "date": 1643619190405,
            "name": "Commit-0",
            "content": "import React, {useState, useEffect, useCallback} from \"react\";\r\nimport { Footer, InputField } from \"../../components\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useCookies } from \"react-cookie\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport TopMed from \"../../store/topMed/action\";\r\nimport SearchZip from \"../../store/SearchZip/action\";\r\nimport { ClearZip } from \"../../store/SearchZip/action\";\r\nimport CurrentMed from \"../../store/currentMed/action\";\r\nimport AutoSuggestInput from '../../components/AutoSuggestInput';\r\nimport {\r\n  HeaderLogoImage,\r\n  LocationIconSvg,\r\n  SearchIconSvg,\r\n} from \"../../assets/images\";\r\nimport \"../../assets/pages/search.scss\";\r\n\r\nexport const SearchPage: React.FC = () => {\r\n  const history = useHistory();\r\n  const state = useSelector((state:any) => state.topMedReducer.top);\r\n  const grouping = useSelector((state:any) => state.topMedReducer.group)\r\n  const [group,setGroup] = useState(false);\r\n  const zip = useSelector((zip:any) => zip.zipReducer);\r\n  const data = useSelector((state:any) => state.currentReducer);\r\n  const [cookies, setCookies] = useCookies();\r\n  const [search, setSearch] = useState(\"\");\r\n  const [error,setError] = useState(false);\r\n  const [zipError,setZipError] = useState(false);\r\n  const [codes, setCodes] = useState(\"\");\r\n  const [groups,setGroups] = useState([]);\r\n  const [filteredItems,setFilteredItems] = useState([]);\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    \r\n    dispatch(TopMed({authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}));\r\n    \r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if(codes){\r\n      dispatch(SearchZip(codes));\r\n    }\r\n    \r\n    return () => {dispatch(ClearZip())}\r\n    \r\n  },[codes,dispatch]);\r\n  useEffect(() => {\r\n    if(data.name){\r\n        history.push({\r\n        pathname:\"/results\",\r\n        state:{\r\n          name: search,\r\n          location: zip.filter((item:any) => item.label === codes),\r\n        }\r\n      })\r\n    }\r\n  }, [data]);\r\n  const submitAction = () => {\r\n    if(search && codes && state.filter((item:any) => item.label === search || item.label.label === search)[0]){\r\n      dispatch(CurrentMed(search,{authorization: `Bearer ${cookies['token']}`, 'x-account-id':cookies['account']}))\r\n      return true;\r\n    }else{\r\n      codes ? setZipError(false) :setZipError(true);\r\n      search && state.filter((item:any) => item.label.label === search)[0] ? setError(false) : setError(true);\r\n      return false;\r\n    }\r\n  }\r\n  return (\r\n    <div className=\"search-page\">\r\n      <div>\r\n        <div className=\"search-page__header\">\r\n          <img\r\n            src={HeaderLogoImage}\r\n            className=\"search-page__header-logo\"\r\n            alt=\"\"\r\n          />\r\n        </div>\r\n        <div className=\"search-page__content\">\r\n          <h1 className=\"search-page__title\">\r\n            Save on your medications today!\r\n          </h1>\r\n\r\n          <div className=\"search-page__input-wrapper\">\r\n          <InputField\r\n              iconUrl={SearchIconSvg}\r\n              value={search}\r\n              placeholder=\"Search Medications\"\r\n              onChange={setSearch}\r\n              onSubmit={submitAction}\r\n              buttonText=\"Find lowest prices\"\r\n              autocomplete={search.length >= 3 && group === false ? state : []}\r\n              errorHandle={error}\r\n              grouping={true}\r\n              filtered={filteredItems}\r\n              setFiltered={setFilteredItems}\r\n              // error=\"Please type correct medication\"\r\n            />\r\n            {error ? (\r\n              <p className=\"error_message\">Please choose correct medication</p>\r\n            ) : (\r\n              <p></p>\r\n            )}\r\n            <InputField\r\n              iconUrl={LocationIconSvg}\r\n              value={codes}\r\n              placeholder=\"ZIP (enter at least 3 characters)\"\r\n              onChange={setCodes}\r\n              onSubmit={submitAction}\r\n              buttonText=\"Find lowest prices\"\r\n              autocomplete={zip}\r\n              errorHandle={zipError}\r\n              haveSubmit\r\n              // error=\"Please type correct ZIP code\"\r\n            />\r\n            {zipError ? (\r\n              <p className=\"error_message\">Please choose correct Zip code</p>\r\n            ) : (\r\n              <p></p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <Footer />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SearchPage;\r\n"
        }
    ]
}